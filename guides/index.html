<style type="text/css" media="screen">
/*
.nodes-image {
	margin:-100;
}
*/	
@import url("//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css");

.imageblock .content img, .image img {max-width: 900px;max-height: 300px;}
.deck h3, .deck h4 {display: block !important;margin-bottom:8px;margin-top:5px;}
.listingblock {margin:8px;}
.pull-bottom {position:relative;bottom:1em;}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.admonitionblock.note.speaker { display:none; }
</style>
<style type="text/css" media="screen">
/* #editor.maximize-editor .CodeMirror-code { font-size:24px; line-height:26px; } */
</style>
<article class="guide" ng-controller="AdLibDataController">
  <carousel class="deck container-fluid">
    <!--slide class="row-fluid">
      <div class="col-sm-3">
        <h3>NGLY1 Deficiency Knowledge Graph in Neo4j</h3>
        <p class="lead">Information</p>
			<!dl>
				
				
				<dt>author"</dt><dd>Núria Queralt Rosinach</dd>
				
				
			</dl>
		</div>
      <div class="col-sm-9">
        <figure>
          <img style="width:300px" src=""/>
        </figure>
      </div>
    </slide-->
    


<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>NGLY1 Deficiency Knowledge Graph in Neo4j</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>The NGLY1 Deficiency Knowledge Graph is the first knowledge network for the <a href="https://rarediseases.info.nih.gov/diseases/12315/deficiency-of-n-glycanase-1">Deficiency of N-glycanase 1 or NGLY1 Deficiency</a>, which is an ultra-rare genetic disease with neither a treatment nor a clear understanding of the underlying biology. It is a <strong>living structured review</strong> that summarizes the current knowledge and data on the NGLY1 Deficiency in a modern and computable fashion represented as a single graph for exploration and discovery. Knowledge comes from biocuration of the scientific literature and retrieval from biomedical knowledge bases. This knowledge is integrated with omics data from the fruit fly (<a href="https://en.wikipedia.org/wiki/Drosophila_melanogaster"><em>Drosophila melanogaster</em></a>) model, an animal system that has helped the community understand a wide range of human conditions, from alcoholism to Alzheimer&#8217;s disease and Rett&#8217;s syndrome (<a href="http://modencode.sciencemag.org/drosophila/introduction"><em>Drosophila</em> as a model organism</a>). The fruit fly genetics and biology are also used in the Model Organisms Screening Center for the <a href="https://undiagnosed.hms.harvard.edu/research/model-organisms-phase-ii/">Undiagnosed Diseases Network</a> to tackle rare and undiagnosed diseases. The parallels between the genomes of Drosophila and humans, over about 60%, provides an opportunity to reveal basic genes or processes associated with disease.</p>
</div>
<div id="img-app" class="imageblock" style="float: center;">
<div class="content">
<a class="image" href="http://ngly1graph.org/contribute/"><img src="https://www.dropbox.com/s/tvexo76iqduivjw/ngly1_app_logo_youRInNeo4j3.png?dl=1" alt="ngly1 app logo youRInNeo4j3" width="2500px" height="1250px"></a>
</div>
<div class="title">Figure 1. NGLY1 Deficiency Knowledge Graph application. Go to the <strong>Wikibase site</strong> by clicking the application logo.</div>
</div>
<div class="paragraph">
<p><br></p>
</div>
<div class="paragraph">
<p>This is the <strong>Neo4j Web interface</strong> for the NGLY1 Deficiency Knowledge Graph to visualize, run queries and explore the structured reviewed knowledge and data. This application provides read-only access to the graph. To contribute new information to the graph, the user should refer to <a href="http://ngly1graph.org/contribute/">NGLY1 Deficiency Knowledge Graph in Wikibase</a> site of the project, a collaborative and community-editable version of the graph. Neo4j and Wikibase are synchronized as a single application to provide access to the NGLY1 Deficiency Knowledge Graph. <em>Note that</em> this is a living graph because the users community can build and curate it in Wikibase. For that reason, static descriptions in the guide such as content statistics, data model and screenshots may differ with the current time evolving graph. The first deployed NGLY1 Deficiency Knowledge Graph is version v3.2 and contains <strong>234,714</strong> relationships of 29 types among <strong>9,359</strong> nodes of 8 types.</p>
</div>
<div class="paragraph">
<p><br></p>
</div>



   <h4>DISCOVER FROM THE STRUCTURED KNOWLEDGE-DATA REVIEWED</h4>
   <div class="paragraph">
<p>The NGLY1 Deficiency Knowledge Graph is a network of biological and clinical relations offered as a knowledge resource to the research community to enable discovery on its cause and of its symptoms. The network is disease domain specific to NGLY1 Deficiency and can be used for different research questions from the analysis of disease gene functions, the investigation of the genetic basis and underlying molecular biology of disease phenotypes, to the discovery of hypothesis or explanations linking concepts in the graph. Examples of the kind of questions the user can formulate are:</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>What are the most common gene functions, gene interactions, cellular processes or phenotypes associated with the perturbed gene expression in Drosophila?</p>
</li>
<li>
<p>What are the human homologs related to the perturbed transcriptome in the NGLY1 Deficiency fly model?</p>
</li>
<li>
<p>What are the most common human Transcription Factors (TFs) associated with the genes in the fly transcriptome?</p>
</li>
<li>
<p>Have the fly transcriptome homolog genes in human or their gene interactors been associated with NGLY1 Deficiency phenotypes?</p>
</li>
<li>
<p>Can we retrieve explanations or paths linking two entities of interest such as two genes? What are the most common path topologies or metapaths linking these genes? Are there paths based on regulatory TF-target gene interactions in the structured review?</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>The knowledge graph can be queried in almost an infinite number of ways. This guide will demonstrate two such queries as templates for you to customize.</p>
</div>
<div class="paragraph">
<p><br></p>
</div>



   <h4>DATA MODEL</h4>
   <div class="paragraph">
<p>The figure 1 shows the data model or schema or meta-graph for NGLY1 Deficiency Knowledge Graph v3.2. Click the figure to zoom out.</p>
</div>
<div id="img-schema" class="imageblock" style="float: center;">
<div class="content">
<a class="image" href="https://www.dropbox.com/s/6m1rfik5qqftyvi/ngly1kg_metagraph_2019-03-12.png?dl=0"><img src="https://www.dropbox.com/s/6m1rfik5qqftyvi/ngly1kg_metagraph_2019-03-12.png?dl=1" alt="ngly1kg metagraph 2019 03 12"></a>
</div>
<div class="title">Figure 2. NGLY1 Deficiency Knowledge Graph v3.2 data model</div>
</div>
<div class="paragraph">
<p>For an interactive description of the data model, run the following query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->CALL db.schema()<!--/code--></pre>
</div>
</div>
<div class="paragraph">
<p><br></p>
</div>



   <h4>Data types</h4>
   <div class="paragraph">
<p>The network relates data of 8 types: <strong>genes</strong> (<code>GENE</code>), <strong>disease phenotypes</strong> (<code>DISO</code>), <strong>variants</strong> (<code>VARI</code>), <strong>genotypes</strong> (<code>GENO</code>), <strong>pathways</strong> (<code>PHYS</code>), <strong>chemicals</strong> (<code>CHEM</code>), <strong>anatomy</strong> (<code>ANAT</code>), and <strong>organisms</strong> (<code>LIVB</code>) with different levels of association expressiveness (29 edge types). Data and relations are described using standard semantics: community-driven ontologies and controlled vocabularies to enable interoperability with external resources and reduce ambiguity. To see the frequency of node types, run the following query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->MATCH (n) RETURN DISTINCT labels(n), COUNT(DISTINCT n.id) AS nodes ORDER BY nodes DESC<!--/code--></pre>
</div>
</div>
<div class="paragraph">
<p><br></p>
</div>
<div class="paragraph">
<p>The semantics of the concepts in the graph rely on the semantic types that build the <a href="https://www.nlm.nih.gov/pubs/factsheets/umlssemn.html">UMLS Semantic Network</a>. To check the definition of each semantic type abbreviation see the <a href="https://metamap.nlm.nih.gov/Docs/SemGroups_2013.txt">UMLS Semantic Groups definitions</a>. The semantics of the relations rely basically on the <a href="http://www.obofoundry.org/ontology/ro.html">Relation Ontology (RO)</a>. To see the frequency of semantic relation types, run the following query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->MATCH path=(n)-[r]-&gt;(m) RETURN DISTINCT type(r) AS id, r.property_label AS label, COUNT(DISTINCT path) AS paths ORDER BY paths DESC<!--/code--></pre>
</div>
</div>
<div class="paragraph">
<p><br></p>
</div>



   <h4>ID scheme</h4>
   <div class="paragraph">
<p>The semantics of the data instances rely on 87 different specific ontologies and vocabularies in function of the concept type:</p>
</div>
<table class="table tableblock frame-all grid-all" style="width: 100%;">
<caption class="title">Table 1. Relation of data instance and ID scheme namespaces used</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Node type</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ID scheme</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Genes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HGNC, NCBI Gene, FlyBase, ZFIN, MGI, RGD, XenBase, WormBase, UniProt, SGD, Ensembl, React, InterPro, EC, GO</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Diseases phenotypes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MP, FBbt, HP, ZP, WBPhenotype, FBcv, AQTLTrait, MONDO, OMIM, DOID, APO, Orphanet</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Variants</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ClinVar, SO</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Genotype</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Monarch, Coriell, MMRRC</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pathways</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GO, Reactome, KEGG, MESH, CHEBI, FOODON, HP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Chemicals</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ChEBI, DrugBank, HMDB, UMLS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Anatomy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UBERON, CL, GO, EDAM</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Organism</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NCBITaxon</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><br></p>
</div>



   <h4>Data attributes</h4>
   <div class="paragraph">
<p>The graph data are created as two different data structures: nodes and edges. Their data attributes are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Node</strong></p>
<div class="ulist">
<ul>
<li>
<p><code>id</code>: Entity identifier in an domain specific ontology or controlled vocabulary.</p>
</li>
<li>
<p><code>preflabel</code>: Preferred human-readable label for the entity. In case of genes, this is the gene symbol.</p>
</li>
<li>
<p><code>name</code>: Common known term used by the community to refer to the entity.</p>
</li>
<li>
<p><code>description</code>: Short sentence describing the entity.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Edge</strong></p>
<div class="ulist">
<ul>
<li>
<p><code>property_label</code>: Preferred human-readable label for the property or type of association in the edge.</p>
</li>
<li>
<p><code>property_uri</code>: <a href="https://en.wikipedia.org/wiki/Uniform_Resource_Identifier">Uniform Resource Identifier (URI)</a> to identify the property. URIs are the Web standard identifier and allow accessing to metadata by dereferrencing them, and linking to other data in the Web.</p>
</li>
<li>
<p><code>reference_uri</code>: URI to identify the reference where the association (edge) is claimed, i.e. the provenance.</p>
</li>
<li>
<p><code>reference_supporting_text</code>: Sentence extracted from the reference where the edge is stated, i.e. the evidence.</p>
</li>
<li>
<p><code>reference_date</code>: Date of publication of the reference of the edge.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>NOTE</em>: The attribute(s) do not appear in the graphical interface when the value is null.</p>
</div>
<div class="paragraph">
<p><br></p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Click the top right <strong>black&amp;white</strong> arrow to go to the next page
</td>
</tr>
</table>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Data</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>The NGLY1 Deficiency Knowledge Graph reviews heterogeneous <strong>knowledge</strong> from basic biological and clinical research in humans and derived from animal models, and <strong>data</strong> generated from high-throughput experiments. The integrated knowledge and data comes from different external sources including scientific literature, knowledge bases and experimental omics data sets and are annotated to its provenance and evidence. The integration is performed by means of vocabulary mapping and normalization. We provide a computational tool for the reproducible generation workflow of the graph, a <a href="https://github.com/NuriaQueralt/bioknowledge-reviewer">Python library</a> where each data source has a specific module to prepare edges as a network to be integrated into the NGLY1 Deficiency Knowledge Graph schema.</p>
</div>
<div class="paragraph">
<p>We reviewed and structured <em>knowledge</em> with its evidence around the clinical profile and the pathophysiology of the NGLY1 Deficiency to help biomedical researchers to discover evidence-based explanations for their hypotheses on its cause and of its symptoms. We assembled <strong>human</strong> diverse knowledge about basic molecular biology, cys-regulation, and clinical disease phenotypes extracted by biocuration of publications in scientific journals, retrieved from databases, and knowledge from domain experts. We derived knowledge from <strong>animal models</strong> assembling homologs and ortholog-phenotypes. This knowledge is complemented and gives structure to new experimental transcriptomics <em>data</em> from recent studies.</p>
</div>
<div class="paragraph">
<p><br></p>
</div>



   <h4>ORIGINAL DATA SOURCES</h4>
   <div class="paragraph">
<p>The third release of the graph organizes information as edges from human and animal models 1) manually extracted from investigations published in <a href="https://www.ncbi.nlm.nih.gov/pubmed/">PubMed</a>; 2) retrieved from <a href="https://monarchinitiative.org/">the Monarch Initiative</a>; 3) transcription factor regulation from several sources in <a href="https://github.com/slowkow/tftargets">tftargets</a> and the <a href="http://software.broadinstitute.org/gsea/msigdb">Molecular Signatures Database or MSigDB</a>; 4) manually contributed by the community from <a href="http://ngly1graph.org/contribute/">the NGLY1 Deficiency Wikibase platform</a>; and integrates all this heterogeneous knowledge with an experimental gene expression data set from a fruit fly <em>Drosophila melanogaster</em> model of the disease <a href="https://www.ncbi.nlm.nih.gov/pubmed/29346549">Owings <em>et al</em>.</a>. We have ingested existing data into a knowledge graph creating first several networks, which type of content is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Knowledge:</p>
<div class="ulist">
<ul>
<li>
<p>Human heterogeneous edges: curation, Monarch and regulation networks</p>
</li>
<li>
<p>Animal model homologs and ortholog-phenotypes edges: Monarch network</p>
</li>
</ul>
</div>
</li>
<li>
<p>Data:</p>
<div class="ulist">
<ul>
<li>
<p>Omics edges: transcriptomics network</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><br></p>
</div>
<div class="paragraph">
<p>Networks are assembled and organized according the types and source of edges:</p>
</div>



   <h4>Curation Network</h4>
   <div class="paragraph">
<p>Data come from manual curation. We manually curated <a href="https://www.ncbi.nlm.nih.gov/pubmed/24651605">Enns <em>et al</em>., 2014</a> and <a href="https://www.ncbi.nlm.nih.gov/pubmed/27388694">Lam <em>et al</em>., 2017</a> publications to capture the known pathophysiology and clinical phenotypic spectrum of the disease. From free text in Lam <em>et al</em>., we structured around 100 associated disease phenotypes and formalized them into the HPO. Data are retrieved from <a href="https://github.com/NuriaQueralt/bioknowledge-reviewer/tree/master/bioknowledge_reviewer/curation/data/v20180118">tabulated files</a> generated by the biocurator. Network files: <a href="https://github.com/NuriaQueralt/ngly1-graph/blob/master/regulation/graph/curated_v20180118/curated_nodes_v2019-01-18.csv"><em>nodes</em></a>, <a href="https://github.com/NuriaQueralt/ngly1-graph/blob/master/regulation/graph/curated_v20180118/curated_edges_v2019-01-18.csv"><em>edges</em></a>.</p>
</div>



   <h4>Monarch Network</h4>
   <div class="paragraph">
<p>Data come from the Monarch Initiative Knowledge Base. To translate genotype and phenotype, the knowledge base semantically integrates animal model with human data such as diseases, genes, variants, or phenotypes. They are retrieved through the BioLink API. Data are obtained for specific seed nodes requested by NGLY1 Deficiency researchers using the <a href="https://github.com/NuriaQueralt/bioknowledge-reviewer/blob/master/bioknowledge_reviewer/graph_v3.2_v20190616.ipynb">workflow</a>. Network files: <a href="https://github.com/NuriaQueralt/ngly1-graph/blob/master/monarch/1shell-animal/add-connections-to-net/monarch_nodes_v2019-01-16.tsv"><em>nodes</em></a>, <a href="https://github.com/NuriaQueralt/ngly1-graph/blob/master/monarch/1shell-animal/add-connections-to-net/monarch_edges_v2019-01-16.tsv"><em>edges</em></a>.</p>
</div>



   <h4>Regulation Network</h4>
   <div class="paragraph">
<p>Data come from the tftargets and the MSigDB databases and consist of known human transcription factor and target genes associations.</p>
</div>
<div class="paragraph">
<p><strong>tftargets</strong> R package provides TF-genes associations data from 6 databases with different type of evidence. We retrieved only data from TRED, ENCODE, Neph2012 and TRRUST databases because they have reliable curated or experimental evidence. Data are retrieved from the GitHub tftargets repository as a bulk download. Data come from the <a href="https://github.com/slowkow/tftargets/blob/master/data/tftargets.rda">tftargets.rda files</a> and provenance from the <a href="https://github.com/slowkow/tftargets/blob/master/data-raw/TRRUST/trrust_rawdata.txt.gz">TRRUST raw data file</a>.</p>
</div>
<div class="paragraph">
<p><strong>MSigDB</strong> is a collection of annotated gene sets for use with GSEA software. Data are retrieved from the MSigDB web site as a bulk download. We use the C3:TFT gene set collection from the <a href="https://github.com/NuriaQueralt/bioknowledge-reviewer/blob/master/bioknowledge_reviewer/regulation/msigdb/data/c3.tft.v6.1.entrez.gmt">entrez genes ids GMT file</a>.</p>
</div>
<div class="paragraph">
<p>Network files: <a href="https://github.com/NuriaQueralt/ngly1-graph/blob/master/regulation/graph/regulation_nodes_v2019-01-17.csv"><em>nodes</em></a>, <a href="https://github.com/NuriaQueralt/ngly1-graph/blob/master/regulation/graph/regulation_edges_v2019-01-17.csv"><em>edges</em></a>.</p>
</div>



   <h4>Transcriptomics Network</h4>
   <div class="paragraph">
<p>Data come from an RNA-seq experiment on the perturbed transcriptome in a fly model of NGLY1 Deficiency <a href="https://www.ncbi.nlm.nih.gov/pubmed/29346549">Owings <em>et al</em>., 2018</a>. It contains the differential expression at cutoffs of absolute fold change &gt; 1.5 and false discovery rate &lt; 0.05. Data are retrieved from data authors by request. Data are obtained from the <a href="https://github.com/NuriaQueralt/bioknowledge-reviewer/blob/master/bioknowledge_reviewer/transcriptomics/ngly1-fly-chow-2018/data/supp_table_1.csv">CSV file</a>. Network files: <a href="https://github.com/NuriaQueralt/ngly1-graph/blob/master/regulation/graph/rna_nodes_v2019-01-17.csv"><em>nodes</em></a>, <a href="https://github.com/NuriaQueralt/ngly1-graph/blob/master/regulation/graph/rna_edges_v2019-01-17.csv"><em>edges</em></a>.</p>
</div>
<div class="paragraph">
<p><br></p>
</div>



   <h4>DATA STATISTICS</h4>
   <div class="paragraph">
<p>In the following table we show the dimensions of each network before integration into the graph, and the dimensions of the final NGLY1 Deficiency Knowledge Graph (KG) and the statistics of each data source finally integrated.</p>
</div>
<div class="paragraph">
<p><br></p>
</div>
<table class="table tableblock frame-topbot grid-rows" style="width: 100%;">
<caption class="title">Table 2. Data statistics per network</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Source</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Nodes</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Edges</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><em>Before integration</em></strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Curation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">302</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">362</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Monarch</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4,644</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32,715</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Regulation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16,963</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">197,267</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transcriptomics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">386</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">386</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><em>After integration</em></strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NGLY1 Deficiency KG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9,365</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">237,027</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Curation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">302</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">362</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Monarch</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4,644</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">226,556</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Regulation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4,226</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9,723</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transcriptomics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">386</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">386</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><br></p>
</div>



   <h4>DATA AVAILABILITY</h4>
   <div class="paragraph">
<p>Files used to build the NGLY1 Deficiency Knowledge graph v3.2 are available at:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Curation network files: <a href="https://github.com/NuriaQueralt/ngly1-graph/blob/master/regulation/graph/curated_graph_nodes_v2019-01-18.csv"><em>nodes</em></a>; <a href="https://github.com/NuriaQueralt/ngly1-graph/blob/master/regulation/graph/curated_graph_edges_v2019-01-18.csv"><em>edges</em></a></p>
</li>
<li>
<p>Monarch network files: <a href="https://github.com/NuriaQueralt/ngly1-graph/blob/master/regulation/graph/monarch_nodes_v2019-01-18.tsv"><em>nodes</em></a>; <a href="https://github.com/NuriaQueralt/ngly1-graph/blob/master/regulation/graph/monarch_edges_v2019-01-18.tsv"><em>edges</em></a></p>
</li>
<li>
<p>Regulation network files: <a href="https://github.com/NuriaQueralt/ngly1-graph/blob/master/regulation/graph/regulation_nodes_v2019-01-17.csv"><em>nodes</em></a>; <a href="https://github.com/NuriaQueralt/ngly1-graph/blob/master/regulation/graph/regulation_graph_edges_v2019-01-17.csv"><em>edges</em></a></p>
</li>
<li>
<p>Transcriptomics network files: <a href="https://github.com/NuriaQueralt/ngly1-graph/blob/master/regulation/graph/rna_nodes_v2019-01-17.csv"><em>nodes</em></a>; <a href="https://github.com/NuriaQueralt/ngly1-graph/blob/master/regulation/graph/rna_edges_v2019-01-17.csv"><em>edges</em></a></p>
</li>
</ul>
</div>



   <h4>NGLY1 Deficiency Knowledge Graph files:</h4>
   <div class="ulist">
<ul>
<li>
<p>NGLY1 Deficiency Knowledge Graph in <strong>CSV data</strong>: <a href="https://github.com/NuriaQueralt/ngly1-graph/tree/master/neo4j-graphs/ngly1-v3.2/import/ngly1"><em>network files</em></a></p>
</li>
<li>
<p>NGLY1 Deficiency Knowledge Graph in <strong>FAIR data</strong>: <a href="https://github.com/NuriaQueralt/ngly1-graph/blob/master/wikibase-rdf/ngly1_wikibase.rdf.gz">RDF</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><br></p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Click the top right <strong>black&amp;white</strong> arrow to go to the next page
</td>
</tr>
</table>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Explore reviewed knowledge for hypothesis discovery</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>In the following slides, we will query the graph to showcase how to explore this heterogeneous knowledge to extract potential hypotheses focusing on a specific research question.</p>
</div>
<div class="paragraph">
<p><br></p>
</div>



   <h4>RESEARCH QUESTION</h4>
   <div class="paragraph">
<p>Consider a researcher wants to determine whether a novel protein Aquaporin 1 (AQP1) is related with the NGLY1 Deficiency. From the experimental observation, the researcher has identified a causal association between NGLY1 and AQP1 genes at expression level in both a mouse model and patient data, but the mechanism of that association is not known. The researcher&#8217;s hypothesis is that both genes are linked through transcriptional regulation and she wants to search the knowledge and the expression data integrated in the review to find potential mechanisms and, if so, to link these mechanisms to the disease phenotypes. Here, we demonstrate how to extract potential mechanistic paths from the knowledge graph. To answer this complex question we will perform two different queries:</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>First we will query for NGLY1-AQP1 genetic association evidence</p>
</li>
<li>
<p>Then we will perform a second query to retrieve gene-disease association evidence</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p><br></p>
</div>



   <h4>SET UP THE NEO4J BROWSER</h4>
   <div class="paragraph">
<p>You are currently interacting with the NGLY1 Deficiency knowledge graph through the Neo4j Browser, which provides a web interface to the database where you can run queries and explore the connected knowledge.</p>
</div>
<div class="paragraph">
<p>We first style the graph, before playing with it. To load the NGLY1 Deficiency graph style into the Neo4j Browser, run the following command by clicking the box, which will populate the shell, and hitting <code><code>enter</code></code> (or <code><code>return</code></code> in some keyboards). This command only needs to be run once per web browser.</p>
</div>
<div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->:style http://ngly1graph.org:8001/guides/style.grass<!--/code--></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The user can set up the style of the graph by itself locally in its browser. If you click on any label or relationship above the graph visualization, you can then choose its styling in the area below the graph. Colors, sizes, and captions are selectable from there. To reset a style the user can execute <code>:style reset</code>. Click <a href="http://guides.neo4j.com/browser.html">Styling Neo4j Browser Visualization</a> for more details.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p> <br></p>
</div>
<div class="paragraph">
<p>To explore the knowledge graph, go first to the browser settings at the bottom of the left frame and de-select the <code>Connect result nodes</code> option to get only the explicit connecting paths. This action needs to be done every time the user opens the browser.</p>
</div>
<div class="paragraph">
<p><br></p>
</div>



   <h4>QUERY 1: HYPOTHESIS DISCOVERY RELATING TWO GENES</h4>
   <div class="paragraph">
<p>This first query describes the situation where a link between two genes has been experimentally confirmed but the mechanism is unknown.  For example, researchers have recently identified that AQP1 and NGLY1 are functionally related. Here, we show how the NGLY1 Deficiency Knowledge Graph can be used to identify mechanistic hypotheses.</p>
</div>
<div class="paragraph">
<p>In particular, we are searching for regulatory hypotheses that link NGLY1 and AQP1 through gene regulatory interactions. To mine the gap of knowledge to identify regulatory mechanistic links, we will explore for paths that link the perturbed transcriptomic expression in a fly model of NGLY1 Deficiency through regulatory TF-target gene interactions to human AQP1. Since we are translating fly biology to human biology we will explore paths with a rule of 2-hop <code>gene-interacts with</code> to allow certain flexibility.</p>
</div>
<div class="paragraph">
<p><br></p>
</div>



   <h4>Define the query template</h4>
   <div class="paragraph">
<p>The first think to do is to formulate the query template in a structured manner to answer this question:</p>
</div>
<div class="paragraph">
<p><br></p>
</div>
<div class="imageblock" style="text-align: center;">
<div class="content">
<img src="https://www.dropbox.com/s/q2ncinoocvquuv0/q1_topology_guidecolors.png?dl=1" alt="q1 topology guidecolors" width="3621" height="100">
</div>
</div>
<div class="paragraph">
<p><br></p>
</div>
<div class="paragraph">
<p>In this template, we specify relations between genes to be of two types: 1) <code>'interacts with'</code> that with the use of filters on edge attributes will be explicitly either of <em>regulatory</em> origin (once filtered by source of provenance to the databases <strong>tftargets</strong> and <strong>MSigDB</strong>), or of <em>gene expression</em> origin (once filtered by reference to the <strong>PubMed Identifier</strong>, where the experimental fly transcriptome data set was published), or of a general <em>gene-gene interaction</em> origin (if none of these restrictions are applied); and 2) <code>'in 1 to 1 orthology relationship with'</code> that relates to direct orthology between genes.</p>
</div>
<div class="paragraph">
<p>If the user does not have a clear idea for a query template, she/he could formulate an open query <em>a priori</em> to retrieve the meta-paths of all links between two entities in the review graph. For an example of how to query the graph to retrieve meta-paths, go to the extended tutorial (find how to access the extended tutorial in the last slide).</p>
</div>
<div class="paragraph">
<p><br></p>
</div>



   <h4>Formulate the query in Cypher and execute it</h4>
   <div class="paragraph">
<p>Once we have a clear query template we can create the query in Cypher to search for mechanistic links based on gene interactions and regulation edges. The following query traverses the graph to find these kind of links in the review. The query sets the topology of the query, i.e. the meta-path or semantics or the sequence of types of nodes and edges, and the rules and constrains to fire potential explanations.</p>
</div>
<div class="paragraph">
<p><strong>Execute the query yourself and explore paths that relate NGLY1 and AQP1 through gene interactions</strong></p>
</div>
<div class="paragraph">
<p>To execute the query, click the text box below to pre-fill the shell at the top of the screen and then hit <code>enter</code> or <code>return</code> in the upper right.</p>
</div>
<div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->MATCH path=(source:GENE)-[i1:`RO:0002434`]-&gt;(rna:GENE)-[i2:`RO:HOM0000020`]-(ortholog_rna:GENE)-[i3:`RO:0002434`]-(tf:GENE)-[i4:`RO:0002434`]-&gt;(target:GENE)

WHERE source.preflabel = 'Pngl' AND target.preflabel = 'AQP1' AND ALL(x IN nodes(path) WHERE single(y IN nodes(path) WHERE y = x))

WITH path,

[n IN nodes(path) WHERE n.preflabel IN ['cytoplasm','cytosol','nucleus','metabolism','membrane','protein binding','visible','viable','phenotype']] AS nodes_marked,

[r IN relationships(path) WHERE toLower(r.reference_supporting_text) =~ '.*tftargets.*|.*msigdb.*'] AS interactions

WHERE size(nodes_marked) = 0 AND size(interactions) &lt;&gt; 0

AND toLower(i1.reference_uri) CONTAINS 'pubmed/29346549'

AND toLower(i4.reference_supporting_text) =~ '.*tftargets.*|.*msigdb.*'

RETURN path<!--/code--></pre>
</div>
</div>
<div class="paragraph">
<p><br></p>
</div>
<div class="paragraph">
<p>Let&#8217;s explain this query statement by statement. First, we look for mechanisms that match the query template above, where we define gene interactions with the node type <em>GENE</em> and the edge types  <em>RO:0002434</em> (<code>interacts with</code>) and <em>RO:HOM0000020</em> (<code>in 1 to 1 orthology relationship with</code>):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>MATCH path=(source:GENE)-[i1:`RO:0002434`]-&gt;(rna:GENE)-[i2:`RO:HOM0000020`]-(ortholog_rna:GENE)-[i3:`RO:0002434`]-(tf:GENE)-[i4:`RO:0002434`]-&gt;(target:GENE)</pre>
</div>
</div>
<div class="paragraph">
<p>Then, we filter to specific source and target nodes with the <em>preferred label</em> (<code>preflabel</code>) node attribute. The source is Pngl (FlyBase:FBgn0033050), which is the fly ortholog of the human gene NGLY1, (HGNC:17646) and the target is the human gene AQP1 (HGNC:633):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>WHERE source.preflabel = 'Pngl' AND target.preflabel = 'AQP1'</pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, we could also use the <em>identifier</em> (<code>id</code>) node attribute to filter to specific entities without ambiguity:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>WHERE source.id = 'FlyBase:FBgn0033050' AND target.id = 'HGNC:633'</pre>
</div>
</div>
<div class="paragraph">
<p>and we impose that every every node instance is traversed only once in the path using the following rule:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>AND ALL(x IN nodes(path) WHERE single(y IN nodes(path) WHERE y = x))</pre>
</div>
</div>
<div class="paragraph">
<p>We extract some features from each path to then filter them, using the 'path' variable:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>WITH path,</pre>
</div>
</div>
<div class="paragraph">
<p>We extract nodes with too general meaning as <em>nodes_marked</em>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>[ n IN nodes(path) WHERE n.preflabel IN ['cytoplasm','cytosol','nucleus','metabolism','membrane','protein binding','visible','viable','phenotype'] ] AS nodes_marked,</pre>
</div>
</div>
<div class="paragraph">
<p>We extract regulatory edges filtering by the <code>reference_supporting_text</code> edge provenance attribute as <em>interactions</em>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>[ r IN relationships(path) WHERE toLower(r.reference_supporting_text) =~ '.*tftargets.*|.*msigdb.*' ] AS interactions</pre>
</div>
</div>
<div class="paragraph">
<p>We filter paths that only content specific node instances and at least have one regulatory edge:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>WHERE size(nodes_marked) = 0 AND size(interactions) &lt;&gt; 0</pre>
</div>
</div>
<div class="paragraph">
<p>We filter paths that the first edge, named in the path pattern as 'i1', is a transcriptomic interaction from the experimental dataset published in the PubMed id "PMID:29346549". We filter it by reference provenance using the <code>reference_uri</code> edge attribute:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>AND toLower(i1.reference_uri) CONTAINS 'pubmed/29346549'</pre>
</div>
</div>
<div class="paragraph">
<p>We filter paths that the fourth edge, named as 'i4', is a TF &#8594; GENE regulatory interaction. We define a specific directionality of the interaction to keep the TF function towards AQP1. We filter it by source provenance using the <code>reference_supporting_text</code> edge attribute:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>AND toLower(i4.reference_supporting_text) =~ '.*tftargets.*|.*msigdb.*'</pre>
</div>
</div>
<div class="paragraph">
<p>Last, we retrieve paths:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>RETURN path</pre>
</div>
</div>
<div class="paragraph">
<p><br></p>
</div>



   <h4>Explore hypotheses</h4>
   <div class="paragraph">
<p>Results can be vizualized in a summary table of a list of properties calculated from all paths or in a graph exposing all the paths. In this case we can explore all paths directly in graph format that looks like (click figures to zoom out):</p>
</div>
<div id="img-q1-paths" class="imageblock">
<div class="content">
<a class="image" href="https://www.dropbox.com/s/onwzkxf2pqritok/q1_graph_screenshot.png?dl=0"><img src="https://www.dropbox.com/s/onwzkxf2pqritok/q1_graph_screenshot.png?dl=1" alt="q1 graph screenshot" width="2642" height="1607"></a>
</div>
<div class="title">Figure 3. Query 1 resulting hypotheses</div>
</div>
<div class="paragraph">
<p><br></p>
</div>
<div class="paragraph">
<p>If we want to retrieve a summary table with for instance all genes that are differentially expressed genes of Pngl and AQP1 Transcription Factors (TFs) ordered by the total number of paths they appear such as:</p>
</div>
<div id="img-q1-table" class="imageblock">
<div class="content">
<a class="image" href="https://www.dropbox.com/s/u8ufzxrj2uo6bue/q1_table_screenshot.png?dl=0"><img src="https://www.dropbox.com/s/u8ufzxrj2uo6bue/q1_table_screenshot.png?dl=1" alt="q1 table screenshot" width="2646" height="1122"></a>
</div>
<div class="title">Figure 4. Query 1 summary table</div>
</div>
<div class="paragraph">
<p><br></p>
</div>
<div class="paragraph">
<p>the query should be:</p>
</div>
<div class="paragraph">
<p><strong>Execute the query to get a summary table of gene interactors in the resulting paths</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->MATCH path=(source:GENE)-[i1:`RO:0002434`]-&gt;(rna:GENE)-[i2:`RO:HOM0000020`]-(ortholog_rna:GENE)-[i3:`RO:0002434`]-(tf:GENE)-[i4:`RO:0002434`]-&gt;(target:GENE)

WHERE source.id = 'FlyBase:FBgn0033050' AND target.id = 'HGNC:633' AND ALL(x IN nodes(path) WHERE single(y IN nodes(path) WHERE y = x))

WITH path,rna,tf,

[n IN nodes(path) WHERE n.preflabel IN ['cytoplasm','cytosol','nucleus','metabolism','membrane','protein binding','visible','viable','phenotype']] AS nodes_marked,

[r IN relationships(path) WHERE toLower(r.reference_supporting_text) =~ '.*tftargets.*|.*msigdb.*'] AS interactions

WHERE size(nodes_marked) = 0 AND size(interactions) &lt;&gt; 0

AND toLower(i1.reference_uri) CONTAINS 'pubmed/29346549'

AND toLower(i4.reference_supporting_text) =~ '.*tftargets.*|.*msigdb.*'

RETURN DISTINCT rna.name AS Expressed_gene_name, tf.name AS TF_name, count(distinct path) as Total_paths

ORDER BY Total_paths DESC<!--/code--></pre>
</div>
</div>
<div class="paragraph">
<p><br></p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If the user wants to list ortholog rna genes, replace <code>rna</code> label by <code>ortholog_rna</code> in the query to refer to the third node position in the query template.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><br></p>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Explore reviewed knowledge for hypothesis discovery (continued)</h3>
    <br/>
    <div>
      


   <h4>QUERY 2: HYPOTHESIS DISCOVERY RELATING AQP1 - DISEASE PHENOTYPES</h4>
   <div class="paragraph">
<p>Next question that the researcher wants to explore is the connection between the AQP1 and the NGLY1 Deficiency disease phenotypes. In particular, the researcher wants to query the review to extract paths from genes to phenotypes that link the AQP1-NGLY1 genetic association evidence obtained in the query 1 with the NGLY1 Deficiency phenotypes.</p>
</div>



   <h4>Define the query template</h4>
   <div class="paragraph">
<p>Again, the first think to do is to formulate the query template in a structured manner to answer this question:</p>
</div>
<div class="paragraph">
<p><br></p>
</div>
<div class="imageblock" style="text-align: center;">
<div class="content">
<img src="https://www.dropbox.com/s/gj1q4w8uvd4gsjf/q2_topology_guidecolors.png?dl=1" alt="q2 topology guidecolors" width="3615" height="830">
</div>
</div>
<div class="paragraph">
<p><br></p>
</div>
<div class="paragraph">
<p>The logics of this query is in two steps: 1) to collect first the genetic evidence linking NGLY1 to AQP1 via regulatory hypothesis retrieved from qurey 1, and 2) from this gene collection to retrieve those genes that have association evidence with the disease phenotypes. Consequently, in the first step we have to define again the template used in query 1, and in the second step we define a new template, where we specify a first disease-phenotype relation for the NGLY1 Deficiency disease node (<strong>SOURCE</strong>) and its associated phenoytpes, and a second relation from these phenotypes to the genes collected in the query 1 (<strong>TARGET</strong>) gene nodes.</p>
</div>
<div class="paragraph">
<p><br></p>
</div>



   <h4>Formulate the query in Cypher and execute it</h4>
   <div class="paragraph">
<p>With the query template defined, we can develop the query in Cypher. To identify and extract gene to phenotype mechanistic links we have to formulate rules in Cypher that follows the logics of the hypothesis, and execute the query. The following query traverses the graph to infer plausible associations of the AQP1 gene with the NGLY1 Deficiency phenotypes from the regulatory hypothesis. The query sets the topology of the hypothesis and the rules and constraints to fire potential explanations.</p>
</div>
<div class="paragraph">
<p><strong>Execute the query yourself and explore paths that relate AQP1 to disease phenotypes</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->MATCH path=(source:GENE)-[i1:`RO:0002434`]-&gt;(rna:GENE)-[i2:`RO:HOM0000020`]-(ortholog_rna:GENE)-[i3:`RO:0002434`]-(tf:GENE)-[i4:`RO:0002434`]-&gt;(target:GENE)

WHERE source.id = 'FlyBase:FBgn0033050' AND target.id = 'HGNC:633' AND ALL(x IN nodes(path) WHERE single(y IN nodes(path) WHERE y = x))

WITH path,ortholog_rna,tf,

[n IN nodes(path) WHERE n.preflabel IN ['cytoplasm','cytosol','nucleus','metabolism','membrane','protein binding','visible','viable','phenotype']] AS nodes_marked,

[r IN relationships(path) WHERE toLower(r.reference_supporting_text) =~ '.*tftargets.*|.*msigdb.*'] AS interactions

WHERE size(nodes_marked) = 0 AND size(interactions) &lt;&gt; 0

AND toLower(i1.reference_uri) CONTAINS 'pubmed/29346549'

AND toLower(i4.reference_supporting_text) =~ '.*tftargets.*|.*msigdb.*'

WITH COLLECT(DISTINCT ortholog_rna.id) + COLLECT(DISTINCT tf.id) AS genes

MATCH path=(:DISO {id: 'MONDO:0014109'})--&gt;(ph:DISO)--(g:GENE)

WHERE g.id in genes AND ph.id CONTAINS 'HP:'

RETURN path<!--/code--></pre>
</div>
</div>
<div class="paragraph">
<p><br></p>
</div>
<div class="paragraph">
<p>Let’s explain this query statement by statement. First, we look for mechanisms that match the first query template above, where we define gene interactions with the node type <em>GENE</em> and the edge types <em>RO:0002434</em> (<code>interacts with</code>) and <em>RO:HOM0000020</em> (<code>in 1 to 1 orthology relationship with</code>):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>MATCH path=(source:GENE)-[i1:`RO:0002434`]-&gt;(rna:GENE)-[i2:`RO:HOM0000020`]-(ortholog_rna:GENE)-[i3:`RO:0002434`]-(tf:GENE)-[i4:`RO:0002434`]-&gt;(target:GENE)</pre>
</div>
</div>
<div class="paragraph">
<p>Then, we filter to the specific <em>Pngl</em> source and <em>NGLY1</em> target nodes (using the <code>id</code> attribute), and the no loops in the path rules:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>WHERE source.id = 'FlyBase:FBgn0033050' AND target.id = 'HGNC:633' AND ALL(x IN nodes(path) WHERE single(y IN nodes(path) WHERE y = x))</pre>
</div>
</div>
<div class="paragraph">
<p>To apply rules we need to extract some features from the path, using the 'path', 'ortholog_rna' and 'tf' variables:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>WITH path,ortholog_rna,tf,</pre>
</div>
</div>
<div class="paragraph">
<p>We extract nodes with too general semantics as <em>nodes_marked</em>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>[n IN nodes(path) WHERE n.preflabel IN ['cytoplasm','cytosol','nucleus','metabolism','membrane','protein binding','visible','viable','phenotype']] AS nodes_marked,</pre>
</div>
</div>
<div class="paragraph">
<p>We extract regulatory edges as <em>interactions</em>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>[r IN relationships(path) WHERE toLower(r.reference_supporting_text) =~ '.*tftargets.*|.*msigdb.*'] AS interactions</pre>
</div>
</div>
<div class="paragraph">
<p>We then filter paths that only have specific semantics and at least one regulatory TF-gene edge:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>WHERE size(nodes_marked) = 0 AND size(interactions) &lt;&gt; 0</pre>
</div>
</div>
<div class="paragraph">
<p>We filter paths where the first edge is a transcriptomic gene-gene interaction in the fly model:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>AND toLower(i1.reference_uri) CONTAINS 'pubmed/29346549'</pre>
</div>
</div>
<div class="paragraph">
<p>We finally apply the filter that the last edge in the topology has to be a TF-gene regulatory interaction:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>AND toLower(i4.reference_supporting_text) =~ '.*tftargets.*|.*msigdb.*'</pre>
</div>
</div>
<div class="paragraph">
<p>All the rules applied til this point are exactly the query 1 to retrieve the regulatory genetic evidence between NGLY1 and AQP1. From this statement, starts the logics to link this regulatory gene connections to the phenotypes of the disease. The following statement collects a list of all the human genes involved in the regulatory connections as <em>genes</em>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>WITH COLLECT(DISTINCT ortholog_rna.id) + COLLECT(DISTINCT tf.id) AS genes</pre>
</div>
</div>
<div class="paragraph">
<p>First, we look for all the genes in the graph that have an association of any type with the disease phenotypes. We keep those paths that match the NGLY1 Deficiency disease node, defining the node type <em>DISO</em> and the node <code>id</code> attribute to <em>MONDO:0014109</em> (the MONDO ID of the NGLY1 Deficiency), with its associated phenotypes using an open edge type to a disease phenotype node type with the <em>DISO</em> label, and from these disease phenotypes we match those edges (open type) that relate the disease phenotypes to gene node types using the <em>GENE</em> label. In this template we named the associated NGLY1 Deficiency disease phenotypes as 'ph' and their associated genes as 'g'.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>MATCH path=(:DISO {id: 'MONDO:0014109'})--&gt;(ph:DISO)--(g:GENE)</pre>
</div>
</div>
<div class="paragraph">
<p>Then, we apply the rule to filter the paths to only human genes that are in the regulatory hypothesis, i.e. in the <code>genes</code> list, and to specifically <em>human</em> disease phenotypes, which are identified by the Human Phenotype ontology (HP) that uses the standard id prefix format annotation <code>HP</code>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>WHERE g.id in genes AND ph.id CONTAINS 'HP:'</pre>
</div>
</div>
<div class="paragraph">
<p>Last, we retrieve paths:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>RETURN path</pre>
</div>
</div>
<div class="paragraph">
<p><br></p>
</div>



   <h4>Explore Hypotheses</h4>
   <div class="paragraph">
<p>The resulting gene-phenotype links can be graphically visualized such as:</p>
</div>
<div class="paragraph">
<p><br></p>
</div>
<div id="img-q2-paths" class="imageblock">
<div class="content">
<a class="image" href="https://www.dropbox.com/s/ox1e3rk3vwgoq9e/q2_graph_screenshot.png?dl=0"><img src="https://www.dropbox.com/s/ox1e3rk3vwgoq9e/q2_graph_screenshot.png?dl=1" alt="q2 graph screenshot" width="500" height="500"></a>
</div>
<div class="title">Figure 5. Query 2 resulting hypotheses</div>
</div>
<div class="paragraph">
<p><br></p>
</div>
<div class="paragraph">
<p>or can be summarized as a table such as:</p>
</div>
<div class="paragraph">
<p><br></p>
</div>
<div id="img-q2-table" class="imageblock">
<div class="content">
<a class="image" href="https://www.dropbox.com/s/oc3ykhqrohfjzj1/q2_table_screenshot.png?dl=0"><img src="https://www.dropbox.com/s/oc3ykhqrohfjzj1/q2_table_screenshot.png?dl=1" alt="q2 table screenshot" width="800" height="800"></a>
</div>
<div class="title">Figure 6. Query 2 summary table</div>
</div>
<div class="paragraph">
<p><br></p>
</div>
<div class="paragraph">
<p>where the query should be:</p>
</div>
<div class="paragraph">
<p><strong>Execute the query to get a summary table of phenotypes and the gene list of genes associated with</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->MATCH path=(source:GENE)-[i1:`RO:0002434`]-&gt;(rna:GENE)-[i2:`RO:HOM0000020`]-(ortholog_rna:GENE)-[i3:`RO:0002434`]-(tf:GENE)-[i4:`RO:0002434`]-&gt;(target:GENE)

WHERE source.id = 'FlyBase:FBgn0033050' AND target.id = 'HGNC:633' AND ALL(x IN nodes(path) WHERE single(y IN nodes(path) WHERE y = x))

WITH path,ortholog_rna,tf,

[n IN nodes(path) WHERE n.preflabel IN ['cytoplasm','cytosol','nucleus','metabolism','membrane','protein binding','visible','viable','phenotype']] AS nodes_marked,

[r IN relationships(path) WHERE toLower(r.reference_supporting_text) =~ '.*tftargets.*|.*msigdb.*'] AS interactions

WHERE size(nodes_marked) = 0 AND size(interactions) &lt;&gt; 0

AND toLower(i1.reference_uri) contains 'pubmed/29346549'

AND toLower(i4.reference_supporting_text) =~ '.*tftargets.*|.*msigdb.*'

WITH COLLECT(DISTINCT ortholog_rna.id) + COLLECT(DISTINCT tf.id) AS genes

MATCH path=(:DISO {id: 'MONDO:0014109'})--&gt;(ph:DISO)--(g:GENE)

WHERE g.id in genes AND ph.id CONTAINS 'HP:'

RETURN DISTINCT ph.id AS phenotype_id, ph.preflabel AS phenotype_label, COLLECT(DISTINCT g.name) AS gene_id_list, count(DISTINCT g.id) AS genes

ORDER BY genes DESC<!--/code--></pre>
</div>
</div>
<div class="paragraph">
<p><br></p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Click the top right <strong>black&amp;white</strong> arrow to go to the next page
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><br></p>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Last remarks</h3>
    <br/>
    <div>
      


   <h4>HYPOTHESIS DISCOVERY ON THE NGLY1 DEFICIENCY KNOWLEDGE GRAPH</h4>
   <div class="paragraph">
<p>The NGLY1 Deficiency Knowledge Graph is a <strong>structured review</strong> of the current knowledge around this ultra-rare disease. Reviewing and structuring knowledge as a graph allows exploration of connections between entities otherwise difficult to query in one step and from only one endpoint. The user can explore explicit and implicit knowledge and check the supporting evidence. A graph allows to connect diverse types of nodes and relationships, different sources and importantly different domains and knowledge graphs. Some of the sophisticated queries that can be solved now are thanks to the heterogeneous information integrated from different topics (disease phenotypes, regulatory interactions or biological pathways) and sources (curated, animal, experimental evidence). We showcase how the graph can be interrogated to mine the gap of knowledge from gene to phenotype for instance. Integrating structured knowledge with omics data has the value to anchor data in a conceptual knowledge collection to aid interpretation and to facilitate discovery of new knowledge from experimental data in context.</p>
</div>



   <h4>The Neo4j Browser application</h4>
   <div class="paragraph">
<p>The development of the NGLY1 Deficiency Knowledge Graph and its deployment into the Neo4j Browser application has been done to support researchers for <strong>discovery</strong>. The Neo4j Browser allows exploration through the Cypher query language, and visualization. Remarkably, Neo4j allows to store our graph and offers drivers for languages such as Python to communicate with the connected knowledge and data. Our pursuit is to review the current knowledge around a disease and to make it actionable for humans and machines to accelerate discoveries in the basic sciences for translational use. The knowledge and data landscape of the structured review cannot be extended interactively using the Neo4j Web interface. The graph has also a community-editable <a href="http://ngly1graph.org/contribute/">NGLY1 Deficiency <strong>Wikibase</strong></a> interface intended to <em>engage with the NGLY1 Deficiency research and patient&amp;family community</em> to expand the review with <strong>expert knowledge</strong>. Both graphs applications are synchronized to share the same content. Tracking biomedical with expert knowledge as a knowledge graph is a current strategy for knowledge-driven discovery and precision medicine.</p>
</div>



   <h4>To wrap up</h4>
   <div class="paragraph">
<p>We offer a disease specific knowledge graph to represent and manage knowledge and data around the NGLY1 Deficiency, and a web interface application served by Neo4j for exploration and visualization:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>We integrated and represented existing knowledge and data as an open knowledge graph on the particular topic of a specific rare disease.</p>
</li>
<li>
<p>The knowledge graph makes knowledge and data more accessible to the NGLY1 Deficiency community.</p>
</li>
<li>
<p>The use of semantics makes the knowledge graph linkable and <strong>interoperable</strong> to other resources such as other rare disease knowledge graphs or the Linked Open Data.</p>
</li>
<li>
<p>The knowledge graph allows to ingest crowdsourced statements from the NGLY1 Deficiency Wikibase.</p>
</li>
<li>
<p>The knowledge graph allows graph processing to query entities, their relations to their attributes or to other entities, along with provenance and evidence of where that knowledge was obtained to enable evidence-based discovery for the NGLY1 Deficiency research community.</p>
</li>
<li>
<p>Multi-dimensional complicated information can be now easily queried without specialized knowledge in an interactive way. Based on answers, users can take analysis in new directions and hypothesis.</p>
</li>
<li>
<p>We deployed the knowledge graph on GitHub as flat files, and on an online Neo4j Browser to make it <strong>findable</strong>, <strong>accessible</strong> and <strong>queryable-usable</strong> and <strong>reusable</strong>.</p>
</li>
<li>
<p>We implemented a Python library to make the creation and use of the knowledge graph more <strong>reproducible</strong>.</p>
</li>
<li>
<p>We created a FAIR knowledge graph to the benefit of humans and machines.</p>
</li>
</ul>
</div>



   <h4>MORE QUERIES</h4>
   <div class="paragraph">
<p>There are more examples of queries that can be done from traversing the graph looking for paths connecting entities to transcriptome review-expanded summaries. The user can see more examples in notebooks stored in the <a href="https://github.com/NuriaQueralt/ngly1-graph/tree/master/neo4j-graphs/ngly1-v3.2/cypher-queries">GitHub repository project - queries</a>. These notebooks are written in Python programming language and provide an alternative interface to query the graph that allows to tracking queries and results.</p>
</div>
<div class="paragraph">
<p>For advanced exploration of the graph please, run the following command by clicking the box to access the advanced guide tutorial.</p>
</div>
<div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->:play http://ngly1graph.org:8001/guides/advanced.html<!--/code--></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The user should have installed <a href="https://jupyter.org/">the Jupyter Notebook</a> software and the IPython kernel for Python3 to run and visualize the queries provided.
</td>
</tr>
</table>
</div>
	</div>
  </div>
</slide>
  </carousel>
</article>